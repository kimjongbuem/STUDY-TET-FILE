IPv6 프로토콜 < 네트워크 계층 >
IPv4 보다 주소공간이 확장되고, 헤더 구조가 단순화 됨, 또한 흐름 제어 기능을 지원함.
128비트 : 64prepix vs 64 host

IPv6 헤더구조****)
ver (4) ds/ecn(traffic class) (8) 나머지 flow label.
payload(16) nextHeader(8) hopLimit(8) 
source Address 32*4 = 16byte / destination Address 32*4 = 16byte

flow Label : 흐름제어기능(흐름정보 저장/처리 - 실시간 서비스)
payload ; 헤더를 제외한 패킷의 크기 , NextHeader : 기본 헤더 다음에 이어지는 헤더의 유형을 수신 호스트에 알려줌.
Hop Limit은 ipv4의 Time to Live와 비슷한 기능을 수행함. - 내부에 떠도는 패킷을 디스카드 하기위한.

IPv6의 주소표현****)
버전 6는 얼마 생기지 않아 0000...이런 0의 반복 주소 부분이 많다. 그렇기에 축약을 하기도 하는데, 그 규칙과 규약을 설명하겠다.
규칙1 : 16진수로 표현하며, 16진수 4개를 각 콜론으로 구분한다.
규칙2: 앞에있는 0생략가능
규칙3: 0이 연속으로 나오면 여러개의 colon을 1개로 축약함/ 단 1번만 가능

::ffff:0:0/96은 :: 에 96개의 프레픽스(IP 주소에서 (네트워크 ID)에 해당하는 선두 상위 비트들의 집합을 의미) 0값이 들어감.(ipv4->ipv6 매핑주소)  
prefix(network id(subnet id 포함)) + suffix(host id) , subnet id를 통해 클래스의 네트워크 개수를 구성하는 것을 파악가능.
::1/128 루프백주소 다 0값--> ::/128 - 이 주소는 모든 값을 0으로 설정한 특수한 주소 = 미설정 주소임.
ipv4에서는 localhost가 127.0.0.1 / 1111 1110 1000 = fe80

IPv6는 멀티캐스트 유니캐스트, 애니캐스트로 나뉨.
멀티는 그룹전테 유니는 1:1 애니는 그룹중 아무나~

이동 프로토콜 터널링*****)
터널링의 원리는 이동 호스트가 자신의 고유주소를 유지하면서 인터넷 서비스를 받을라면 게속 이동하는 송수신 호스트간의 라우팅 처리가 매우중요.
-> 프로토콜이 달라도 괜찮앙~
단어들 : 서버, 홈에이전트, foreign 네트웤, 포워딩, 갱신. 인캡슐/딥캡슐레이션/터널링정의/셀룰러망

홈어드레스를 가진 홈에이전트와 그에 대한망이 있고 HoA에 모바일 호스트 1이 저장됨.(HN) - IPv6 보더 라우터.
이제 모바일 호스트가 이동한다. 그럼 foreign 에이전트가 새로온 호스트를 파악하여 CoA(Care of Address)를 갱신해준다.(mh1.prepix <-얘는 다른 에이전트로 가면 계속 갱신)
원리는 3레이어에서 소스와 데스티네이션 주소를 파악해 HoA, prefix 판단 하며 없으면 포워딩 처리함.(확인만 하며 제거안한다 -> 응답을 해줘야함 제거하면 불가..)
그렇기에 포워딩은 각 소스/데스티네이션 어드레스를 한번더 감싸서 보낸다.(s/d[s/d]) 이런식으로 말이다. 이작업을 인캡슐레이션 , 이거를 까서 외부라우터가 확인하는건 딥캡슐레이션.
이제 딥캡슐레이션하여 수신호스트가 맞으면 tcp계층에서 보낸놈한테 ack/nack 보냄(응답 : nack 시 패킷재전송 요청응답)
근데 계속 이런 작업만 하면 트라이 앵글 라우팅 문제가 생길수 있으니.. C.H에게 계속알려준다. (C.H는 해당 외부에이전트에서 홈에이전트의 상대적 호스트 를 가리킴) 이것을 바인딩 업데이트라함.

add1>> 이동호스트는 고유 아이피 주소인 홈주소가 할당되는데 이주소는 호스트 위치가 변해도 갱신이 안됨. = 홈에이전트와 밀접한 관련을 가짐.
add2>> 터널링 정의 : 데이터 스트림(데이터 열)을 인터넷 상에서 가상의 파이프(통로)를 통해 전달시키는 기술

액세스포인터)
ex) wifi full 연결 x -> access Pointer 위치까지만 연결( ip할당안됨 )

기타 네트워크 계층 프로토콜**)
1. ARP 프로토콜
수신호스트의 ip주소를 통하여 수신호스트의 mac 주소를 얻는 프로토콜임.
송신 호스트 ip = 송신호스트 hdd, 수신호스트 ip = 사용자제공, 송신호스트 mac - Lan 카드, 수신호스트 mac : IP주소를 매개변수로하여 arp 프로토콜로 얻음.(캐시-돈-변화)
ex ) host A -- ARP request(packit) -(브로드 캐스팅) --> HostB(mac address plz) --> ARP reply(packit) --> A (get B mac Address)

2. RARP 프로토콜
단순 터미널 기능 시스템 , LAN 카드를 통해 mac 주소를 얻음. 나 이맥주소 쓰는데 이 맥주소쓰는 ip 뭐냐?(브로드 캐스팅)

3. ICMP 프로토콜
오류가 발생한 아이피 패킷에 대한 원인을 송신호스트에게 전달함. 
오류보고메시지 )
DESTINATION UNREACHABLE : 전송했는데 해당 호스트가 없네? 버려야지.. ㅠㅠ // 윈도우 메시지 재전송 OR 할당
SOURCE QUENCH : 공간이 없어 Traffic 폭발, 흐름제어 역할함.
TIME EXCEEDED : Hop Limit역할. 유효기간지남, 패킷이 버려진경우 ㅇㅇ

질의 메시지/컨트롤 메시지)
ECHO REQUEST/REPLY : 특정 에코를 날리고 에코 응답/전송. 신뢰성검증
TIMESTAMP REUEST/REPLY : 두 호스트간의 네트워크 지연 계산. <- 어떤 기준 시각(보통, Epoch)부터 경과 시간을 수치값으로 주는 문자열, 피기배깅내용도 나옴.

ICMP 헤더 형식 -
TYPE 위에 소개한 메시지종류 구분 / CODE 메시지정보에대한 자세한 정보를 담음/ CHECKSUM
-> 메시지는 IP패킷에 캡슐화되어 D/L에 전달됨.

IGMP 프로토콜
멀티캐스트 그룹에 가입하거나 탈퇴시 사용하는 프로토콜임.
그룹관리.(그룹주소 모니터링) 그룹가입 확인및 탈퇴.

